<?xml version = "1.0"?>
<launch>
  <env name="ROSCONSOLE_CONFIG_FILE"
         value="$(eval optenv('ROSCONSOLE_CONFIG_FILE', find('navit_move_base') + '/cfg/log.conf'))"/>
    <param name="/use_sim_time" value="true"/>
    <param name="sim_mode" value="true"/>

    <!-- gdb -->
    <arg name="debug" default="false"/>
    <arg if="$(arg debug)" name="launch_prefix" value="xterm -rv -e gdb -ex run -args"/>
    <arg unless="$(arg debug)" name="launch_prefix" value=""/>

    <!--arg param-->
    <arg name="cmd_vel_topic" default="move_base_cmd_vel" />
    <arg name="odom_topic" default="odom" />
    <arg name="move_forward_only" default="false"/>

    <!-- Map server -->
    <node pkg="map_server" type="map_server" name="map_server" output="screen" args="$(find navit_move_base)/map/gudao.yaml" respawn="false">
        <param name="frame_id" value="map" />
        <remap from="map_mb" to="map"/>
    </node>

    <!-- stage_ros -->
    <node pkg="stage_ros" type="stageros" name="stageros" args="$(find navit_move_base)/worlds/test.world" respawn="false" >
    <param name="base_watchdog_timeout" value="0.2"/>
    <!--remap from="base_scan" to="scan"/-->
    </node>
    <!--router server -->
    <include file="$(find navit_routing)/launch/routing.launch"/>
    <!-- navit_move_base -->
    <node pkg="navit_move_base" type="navit_move_base_node" respawn="false" name="move_base" output="screen" launch-prefix="gdb -ex run --args">

        <rosparam file="$(find navit_move_base)/params/costmap_params/sim_params/global_costmap_common_params.yaml" command="load" ns="global_costmap" />
        <rosparam file="$(find navit_move_base)/params/costmap_params/sim_params/local_costmap_common_params.yaml" command="load" ns="local_costmap" />
        <rosparam file="$(find navit_move_base)/params/costmap_params/sim_params/local_costmap_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/costmap_params/sim_params/global_costmap_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/costmap_params/sim_params/costmap_converter_params.yaml" command="load" />

        <rosparam file="$(find navit_move_base)/params/move_base_params/ep100/move_base_params.yaml" command="load" />

        <rosparam file="$(find navit_move_base)/params/global_planner_params/ep100/nem_global_planner_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/global_planner_params/ep100/global_planner_params.yaml" command="load" />

        <rosparam file="$(find navit_move_base)/params/local_planner_params/ep100/base_local_planner_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/local_planner_params/ep100/dwa_local_planner_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/local_planner_params/ep100/teb_local_planner_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/local_planner_params/ep100/nem_local_planner_params.yaml" command="load" />
        <rosparam file="$(find navit_move_base)/params/local_planner_params/ep100/m100_dock_local_planner_params.yaml" command="load" />

        <param name="record_bag_cfg_path" value="$(find navit_move_base)/cfg/navi_bag_record_topics.yaml"/>
        <param name="navi_bag_path" value="$(env HOME)/.ros/"/>

        <param name="sim_mode" value="true"/>
        <remap from="cmd_vel" to="$(arg cmd_vel_topic)"/>
        <remap from="odom" to="$(arg odom_topic)"/>
    </node>
    <!-- fake_localization -->
    <node name="fake_localization" pkg="fake_localization" type="fake_localization" respawn="false" />

    <!--vel smooth-->
    <include file="$(find navit_velocity_smoother)/launch/vel_smoother_nodelet_ep100.launch"/>

    <!--pid visualization -->
    <!--node name="pid_visual" pkg="move_base" type="pid_plot.py" output="screen" /-->

    <!-- rviz -->
    <!--node pkg="rviz" type="rviz" name="rviz" required="true" args="-d $(find navit_move_base)/rviz/movebase.rviz"/-->

</launch>


